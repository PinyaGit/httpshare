# Настройка автозапуска HTTPShare сервера в Ubuntu

Этот документ описывает, как настроить автоматический запуск сервера HTTPShare в Ubuntu для пользователя `mon`.

## Варианты автозапуска

### Вариант 1: Автозапуск при входе пользователя (рекомендуется)

Этот вариант запускает сервер только когда пользователь `mon` входит в систему.

#### Установка:

1. **Войдите в систему как пользователь `mon`**
2. **Выполните команды:**
   ```bash
   cd /home/mon/httpshare
   chmod +x install-autostart.sh
   ./install-autostart.sh
   ```

#### Преимущества:
- Сервер запускается только при входе пользователя
- Автоматически получает доступ к графической среде
- Легко управлять через пользовательский интерфейс

#### Управление:
- **Проверка статуса:** `curl http://localhost:8080/api/images`
- **Остановка:** `/home/mon/httpshare/stop-server.sh`
- **Логи:** `/home/mon/httpshare/server.log`

### Вариант 2: Автозапуск на уровне системы (systemd)

Этот вариант запускает сервер как системный сервис при загрузке системы.

#### Установка:

1. **Выполните команды с правами sudo:**
   ```bash
   cd /home/mon/httpshare
   chmod +x install-systemd.sh
   sudo ./install-systemd.sh
   ```

#### Преимущества:
- Сервер запускается до входа пользователя
- Автоматический перезапуск при сбоях
- Централизованное управление через systemd

#### Управление:
- **Запуск:** `sudo systemctl start httpshare`
- **Остановка:** `sudo systemctl stop httpshare`
- **Статус:** `sudo systemctl status httpshare`
- **Логи:** `sudo journalctl -u httpshare -f`

## Проверка работы

После установки автозапуска:

1. **Перезагрузите систему**
2. **Войдите как пользователь `mon`**
3. **Проверьте доступность сервера:**
   ```bash
   curl http://localhost:8080/api/images
   ```
4. **Откройте веб-интерфейс:**
   ```
   http://localhost:8080
   ```

## Удаленный доступ

Для доступа к серверу с других компьютеров:

1. **Узнайте IP-адрес Ubuntu машины:**
   ```bash
   ip addr show
   ```

2. **Откройте веб-интерфейс по адресу:**
   ```
   http://IP-АДРЕС:8080
   ```

3. **Для открытия изображений используйте токен:** `SECRET123`

## Устранение неполадок

### Сервер не запускается:
1. Проверьте логи: `/home/mon/httpshare/server.log`
2. Убедитесь, что Node.js установлен: `node --version`
3. Установите зависимости: `npm install`

### Порт 8080 занят:
1. Найдите процесс: `lsof -i :8080`
2. Остановите его: `sudo kill -9 PID`

### Проблемы с графической средой:
1. Убедитесь, что X11 работает: `echo $DISPLAY`
2. Проверьте права доступа: `ls -la ~/.Xauthority`

## Файлы проекта

- `start-server.sh` - скрипт запуска сервера
- `stop-server.sh` - скрипт остановки сервера
- `install-autostart.sh` - установка автозапуска пользователя
- `install-systemd.sh` - установка systemd сервиса
- `httpshare.desktop` - desktop файл для автозапуска
- `systemd-service/httpshare.service` - systemd сервис

## Безопасность

- Сервер доступен только на localhost (127.0.0.1)
- Для удаленного доступа настройте файрвол
- Токен для управления: `SECRET123` 