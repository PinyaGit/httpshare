#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É
# –ó–∞–ø—É—Å–∫–∞—Ç—å —Å –ø—Ä–∞–≤–∞–º–∏ sudo

echo "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ HTTPShare —Å–µ—Ä–≤–µ—Ä—É..."

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∞ sudo
if [ "$EUID" -ne 0 ]; then
    echo "–û–®–ò–ë–ö–ê: –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω —Å –ø—Ä–∞–≤–∞–º–∏ sudo"
    exit 1
fi

# –ü–æ–ª—É—á–∞–µ–º IP-–∞–¥—Ä–µ—Å –º–∞—à–∏–Ω—ã
IP_ADDRESS=$(hostname -I | awk '{print $1}')
echo "IP-–∞–¥—Ä–µ—Å –º–∞—à–∏–Ω—ã: $IP_ADDRESS"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ ufw
if command -v ufw >/dev/null; then
    echo "–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ñ–∞–π—Ä–≤–æ–ª (ufw)..."
    
    # –†–∞–∑—Ä–µ—à–∞–µ–º –ø–æ—Ä—Ç 8080
    ufw allow 8080/tcp
    echo "‚úÖ –ü–æ—Ä—Ç 8080 –æ—Ç–∫—Ä—ã—Ç –≤ —Ñ–∞–π—Ä–≤–æ–ª–µ"
else
    echo "‚ö†Ô∏è  ufw –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ:"
    echo "   sudo apt install ufw"
    echo "   sudo ufw enable"
    echo "   sudo ufw allow 8080/tcp"
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ iptables
if command -v iptables >/dev/null; then
    echo "–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º iptables..."
    iptables -A INPUT -p tcp --dport 8080 -j ACCEPT
    echo "‚úÖ –ü—Ä–∞–≤–∏–ª–æ iptables –¥–æ–±–∞–≤–ª–µ–Ω–æ"
fi

echo ""
echo "=== –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ ==="
echo ""
echo "–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å–∞–º:"
echo "  –õ–æ–∫–∞–ª—å–Ω–æ:  http://localhost:8080"
echo "  –£–¥–∞–ª–µ–Ω–Ω–æ:  http://$IP_ADDRESS:8080"
echo ""
echo "–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:"
echo "  curl http://$IP_ADDRESS:8080/api/images"
echo ""
echo "‚ö†Ô∏è  –í–ê–ñ–ù–û: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!"
echo "   –î–ª—è –∑–∞–ø—É—Å–∫–∞: /home/mon/httpshare/start-server.sh"
echo ""
echo "üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:"
echo "   - –¢–æ–∫–µ–Ω –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è: SECRET123"
echo "   - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é"
echo "   - –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HTTPS –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞" 